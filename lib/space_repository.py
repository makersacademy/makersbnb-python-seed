from lib.space import *

class SpaceRepository:
    def __init__(self, connection):
        self._connection = connection

    def add(self, space):
        rows = self._connection.execute(
            'INSERT into spaces(description, price, user_id, name, fromdate, todate, free_dates) VALUES (%s, %s, %s, %s, %s, %s, %s) RETURNING id', [space.description, space.price, space.user_id, space.name, space.fromdate, space.todate, space.free_dates]
        )
        space.id = rows[0]['id']
        return None

    def all(self):
        rows = self._connection.execute(
            'SELECT * FROM spaces'
        )
        spaces = []
        print(rows)
        for row in rows:
            item = Space(row['id'], row['description'], row['price'], row['user_id'], row['name'], row['fromdate'], row['todate'], row['free_dates'])
            spaces.append(item)
        return spaces
    

# add method for find or filter based on ? user_id? availability?
# [Space(1, house with a pool, 99.99, 1, pool house, 01-01-2024, 31-01-2024, ['01-01-2024', '02-01-2024', '03-01-2024', '04-01-2024', '05-01-2024', '06-01-2024', '07-01-2024', '08-01-2024', '09-01-2024', '10-01-2024', '11-01-2024', '12-01-2024', '13-01-2024', '14-01-2024', '15-01-2024', '16-01-2024', '17-01-2024', '18-01-2024', '19-01-2024', '20-01-2024', '21-01-2024', '22-01-2024', '23-01-2024', '24-01-2024', '25-01-2024', '26-01-2024', '27-01-2024', '28-01-2024', '29-01-2024', '30-01-2024', '31-01-2024'])] == 
# [Space(1, house with a pool, 99.99, 1, pool house, 01-01-2024, 31-01-2024, ['01-01-2024', '02-01-2024', '03-01-2024', '04-01-2024', '05-01-2024', '06-01-2024', '07-01-2024', '08-01-2024', '09-01-2024', '10-01-2024', '11-01-2024', '12-01-2024', '13-01-2024', '14-01-2024', '15-01-2024', '16-01-2024', '17-01-2024', '18-01-2024', '19-01-2024', '20-01-2024', '21-01-2024', '22-01-2024', '23-01-2024', '24-01-2024', '25-01-2024', '26-01-2024', '27-01-2024', '28-01-2024', '29-01-2024', '30-01-2024', '31-01-2024']), Space(2, house with a garden, 199.99, 2, garden house, 01-04-2024, 30-04-2024, ['04-01-2024', '05-01-2024', '06-01-2024', '07-01-2024', '08-01-2024', '09-01-2024', '10-01-2024', '11-01-2024', '12-01-2024', '13-01-2024', '14-01-2024', '15-01-2024', '16-01-2024', '17-01-2024', '18-01-2024', '19-01-2024', '20-01-2024', '21-01-2024', '22-01-2024', '23-01-2024', '24-01-2024', '25-01-2024', '26-01-2024', '27-01-2024', '28-01-2024', '29-01-2024', '30-01-2024', '31-01-2024', '01-02-2024', '02-02-2024', '03-02-2024', '04-02-2024', '05-02-2024', '06-02-2024', '07-02-2024', '08-02-2024', '09-02-2024', '10-02-2024', '11-02-2024', '12-02-2024', '13-02-2024', '14-02-2024', '15-02-2024', '16-02-2024', '17-02-2024', '18-02-2024', '19-02-2024', '20-02-2024', '21-02-2024', '22-02-2024', '23-02-2024', '24-02-2024', '25-02-2024', '26-02-2024', '27-02-2024', '28-02-2024', '29-02-2024', '01-03-2024', '02-03-2024', '03-03-2024', '04-03-2024', '05-03-2024', '06-03-2024', '07-03-2024', '08-03-2024', '09-03-2024', '10-03-2024', '11-03-2024', '12-03-2024', '13-03-2024', '14-03-2024', '15-03-2024', '16-03-2024', '17-03-2024', '18-03-2024', '19-03-2024', '20-03-2024', '21-03-2024', '22-03-2024', '23-03-2024', '24-03-2024', '25-03-2024', '26-03-2024', '27-03-2024', '28-03-2024', '29-03-2024', '30-03-2024', '31-03-2024', '01-04-2024', '02-04-2024', '03-04-2024', '04-04-2024', '05-04-2024', '06-04-2024', '07-04-2024', '08-04-2024', '09-04-2024', '10-04-2024', '11-04-2024', '12-04-2024', '13-04-2024', '14-04-2024', '15-04-2024', '16-04-2024', '17-04-2024', '18-04-2024', '19-04-2024', '20-04-2024', '21-04-2024', '22-04-2024', '23-04-2024', '24-04-2024', '25-04-2024', '26-04-2024', '27-04-2024', '28-04-2024', '29-04-2024', '30-04-2024'])]